<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>MNIST手寫字識別</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="css/styles.css" rel="stylesheet" />
  <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>

</head>

<body class="sb-nav-fixed">
  <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
    <!-- Sidebar Toggle-->
    <button class="btn btn-link btn-lg order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i
        class="fas fa-bars"></i></button>
    <!-- Navbar Brand-->
    <a class="navbar-brand ps-3" href="index.html">Abby's</a>
  </nav>
  <div id="layoutSidenav">
    <div id="layoutSidenav_nav">
      <nav class="sb-sidenav accordion sb-sidenav-light" id="sidenavAccordion">
        <!--SideNav Menu-->
        <div class="sb-sidenav-menu">
          <div class="nav">
            <!--基本資料-->
            <div class="sb-sidenav-menu-heading">基本資料</div>
            <a class="nav-link" href="index.html">
              <div class="sb-nav-link-icon"><i class="bi bi-person-circle"></i></div>
              個人簡歷
            </a>
            <!--作品集-->
            <div class="sb-sidenav-menu-heading">作品集</div>
            <!--深度學習-->
            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseLayouts"
              aria-expanded="false" aria-controls="collapseLayouts">
              <div class="sb-nav-link-icon">
                <i class="bi bi-laptop"></i>
              </div>
              深度學習
              <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
            </a>
            <div class="collapse" id="collapseLayouts" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
              <nav class="sb-sidenav-menu-nested nav">
                <a class="nav-link" href="MNIST.html">MNIST 手寫辨識</a>
                <a class="nav-link" href="cifar10.html">CIFAR-10 彩色影像辨識</a>
                <a class="nav-link" href="beanleaf.html">Kaggle Dataset 豆葉病害分類</a>
              </nav>
            </div>
            <!--資料處理-->
            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapsePages"
              aria-expanded="false" aria-controls="collapsePages">
              <div class="sb-nav-link-icon">
                <i class="bi bi-laptop"></i>
              </div>
              資料處理
              <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
            </a>
            <div class="collapse" id="collapsePages" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
              <nav class="sb-sidenav-menu-nested nav">
                <a class="nav-link" href="covid.html">台灣2024新冠年齡層統計</a>
                <a class="nav-link" href="2330.html">股市分析 以台積電為例</a>
              </nav>
            </div>

            <!--Python 基礎應用-->
            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapsePython"
              aria-expanded="false" aria-controls="collapsePython">
              <div class="sb-nav-link-icon">
                <i class="bi bi-p-square"></i>
              </div>
              Python 基礎應用
              <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
            </a>
            <div class="collapse" id="collapsePython" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
              <nav class="sb-sidenav-menu-nested nav">
                <a class="nav-link" href="PSTGame.html">剪刀石頭布小遊戲</a>
                <a class="nav-link" href="Dice.html">擲骰子小遊戲</a>
                <a class="nav-link" href="tarot.html">LINE官方帳號結合Gemini塔羅牌占卜</a>
              </nav>
            </div>
          </div>
        </div>
      </nav>
    </div>
    <!--===============================-->
    <!--Content-->
    <div id="layoutSidenav_content">
      <main>
        <div class="container-fluid px-4">
          <h1 class="mt-4">MNIST 手寫字識別</h1>
          <ol class="breadcrumb mb-4">
            <li class="breadcrumb-item">作品集</li>
            <li class="breadcrumb-item">深度學習</li>
            <li class="breadcrumb-item active">MNIST 手寫字識別</li>
          </ol>
          <!--MNIST 介紹-->
          <div class="container mb-4">
            <div>
              <h2>MNIST 資料庫介紹</h2>
              <p>MNIST 英文全名（Modified National Institute of Standards and Technology
                database，修改版美國國家標準與技術研究院數據庫）是一個大型手寫數字數據庫，被廣泛用於訓練各種圖像處理系統。它是機器學習和計算機視覺領域的基準數據集。</p>
            </div>
            <hr>
            <div>
              <h2>數據集內容</h2>
              <p>MNIST 數據集包含 70,000 個灰度圖像的手寫數字（0-9），這些圖像分為兩部分：</p>
              <ul>
                <li>訓練集：60,000 個圖像</li>
                <li>測試集：10,000 個圖像</li>
              </ul>
              <p>每個圖像都是 28x28 像素大小，包含一個手寫的數字（0 到 9）。</p>
            </div>
            <hr>
            <div>
              <h2>特徵</h2>
              <ul>
                <li>圖像尺寸：每個圖像是 28x28 像素，共有 784 個像素點。</li>
                <li>灰度圖像：每個像素的值在 0（白色）到 255（黑色）之間。</li>
                <li>類別標籤：每個圖像對應一個標籤，表示圖像中的數字（0-9）。</li>
              </ul>
              <!--ImageCard-->
              <div class="card mb-4">
                <div class="card-header">
                  <i class="bi bi-image"></i>
                  MNIST 數據集圖片範例
                </div>
                <div class="card-body text-center"><img src="assets/img/MNISTdig.png" alt="MNIST 0-9 數字"
                    class="img-fluid">
                  <div class="text-muted text-end">
                    Updated at July-27-2024
                  </div>
                </div>
                <div class="card-footer small d-grid gap-2 d-md-flex justify-content-md-end">
                  <!-- Button trigger modal -->
                  <button class="btn btn-danger me-md-2 btn-lg" data-bs-toggle="modal" data-bs-target="#exampleModal"
                    type="button">程式碼</button>
                </div>
              </div>
            </div>
            <!-- Modal Start -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog modal-xl
modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">顯示 MNIST 數據集中每個數字（0-9）的一個範例圖片</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <pre class="bg-light p-3 rounded">
                      <code>
                        import matplotlib.pyplot as plt
                        import numpy as np
                        import tensorflow as tf
                        # 加載MNIST數據集
                        (x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()

                        # 找到每個數字的第一個範例
                        examples = {}
                        for i in range(10):
                            for j in range(len(y_train)):
                                if y_train[j] == i:
                                    examples[i] = x_train[j]
                                    break

                        # 顯示每個數字的範例圖片
                        plt.figure(figsize=(10, 5))
                        for i in range(10):
                            plt.subplot(2, 5, i+1)
                            plt.imshow(examples[i], cmap='gray')
                            plt.title(f"Digit: {i}")
                            plt.axis('off')
                        plt.tight_layout()
                        plt.show()
                      </code>
                    </pre>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <!-- Modal End -->
            <div>
              <h2>研究方法</h2>
              <p>將使用 TensorFlow 和 Keras 在 Google Colab
                環境中實現一個基於卷積神經網絡（CNN）的手寫數字識別系統。我們將涵蓋數據準備、模型構建、模型訓練以及結果可視化的過程。最終，我們會展示如何比較模型預測與實際數據的結果。</p>
              <h5>步驟一、環境設置與數據準備</h5>
              <p>首先加載 MNIST 數據集並對數據進行預處理。</p>
              <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    import tensorflow as tf
                    from tensorflow.keras.datasets import mnist
                    import matplotlib.pyplot as plt
                    import numpy as np

                    # 加載MNIST數據集
                    (x_train, y_train), (x_test, y_test) = mnist.load_data()

                    # 將數據正規化到0-1區間
                    x_train, x_test = x_train / 255.0, x_test / 255.0

                    # 添加頻道維度
                    x_train = np.expand_dims(x_train, -1)
                    x_test = np.expand_dims(x_test, -1)

                    # 將類別標籤轉換為獨熱編碼
                    y_train = tf.keras.utils.to_categorical(y_train, 10)
                    y_test = tf.keras.utils.to_categorical(y_test, 10)
                  </code>
                </pre>
              </div>
              <p>在這段代碼中，我們完成了以下幾個步驟：</p>
              <div>
                <ul>
                  <li>數據加載: 使用 tf.keras.datasets.mnist.load_data() 函數下載和加載 MNIST 數據集。</li>
                  <li>數據正規化: 將圖像像素值從 0-255 範圍縮放到 0-1 範圍。</li>
                  <li>添加頻道維度: 因為 MNIST 是灰階圖像，我們需要在數據中添加一個額外的維度（頻道數量）。</li>
                  <li>獨熱編碼: 將類別標籤轉換為獨熱編碼格式。</li>
                </ul>
              </div>
            </div>
            <div>
              <h5>步驟二、建立 CNN 模型</h5>
              <p>接下來，我們建立一個簡單的卷積神經網絡來進行數字識別。</p>
              <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    from tensorflow.keras.models import Sequential
                    from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Dropout

                    # 建立模型
                    model = Sequential([
                        Conv2D(32, kernel_size=(3, 3), activation='relu', input_shape=(28, 28, 1)),
                        MaxPooling2D(pool_size=(2, 2)),
                        Conv2D(64, kernel_size=(3, 3), activation='relu'),
                        MaxPooling2D(pool_size=(2, 2)),
                        Flatten(),
                        Dense(128, activation='relu'),
                        Dropout(0.5),
                        Dense(10, activation='softmax')
                    ])

                    # 編譯模型
                    model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])
                  </code>
                </pre>
              </div>
              <p>這個模型包括了以下幾個層：</p>
              <div>
                <ul>
                  <li>卷積層 (Conv2D): 提取圖像的特徵。第一層有 32 個 3x3 的卷積核，第二層有 64 個 3x3 的卷積核。</li>
                  <li>池化層 (MaxPooling2D): 降維並提取最重要的特徵。這裡使用 2x2 的池化窗口。</li>
                  <li>展平層 (Flatten): 將多維的特徵圖展平為一維向量。</li>
                  <li>全連接層 (Dense): 在展平的特徵上進行高層次的學習，這裡有 128 個神經元。</li>
                  <li>丟棄層 (Dropout): 隨機丟棄 50% 的神經元以減少過擬合。</li>
                  <li>輸出層 (Dense): 用於生成最終的分類結果，這裡有 10 個神經元對應於 10 個數字類別，使用 Softmax 激活函數進行分類。</li>
                </ul>
              </div>
            </div>
            <div>
              <h5>步驟三、訓練模型</h5>
              <p>現在我們可以使用 MNIST 訓練數據來訓練我們的模型。</p>
              <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    # 訓練模型
                    history = model.fit(x_train, y_train, epochs=10, batch_size=128, validation_data=(x_test, y_test))
                  </code>
                </pre>
              </div>
              <p>這行代碼會訓練模型10次迭代，批次大小為128，同時在每個迭代結束時進行驗證。</p>
            </div>
            <div>
              <h5>步驟四、可視化模型性能</h5>
              <p>訓練完成後，可視化模型的準確率和損失函數。</p>
              <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    # 繪製 accuracy 圖表
                    plt.plot(history.history['accuracy'], label='train accuracy')
                    plt.plot(history.history['val_accuracy'], label='test accuracy')
                    plt.title('Model Accuracy')
                    plt.xlabel('Epochs')
                    plt.ylabel('Accuracy')
                    plt.legend()
                    plt.show()

                    # 繪製 loss 圖表
                    plt.plot(history.history['loss'], label='train loss')
                    plt.plot(history.history['val_loss'], label='test loss')
                    plt.title('Model Loss')
                    plt.xlabel('Epochs')
                    plt.ylabel('Loss')
                    plt.legend()
                    plt.show()

                  </code>
                </pre>
              </div>
              <p>這段代碼會生成準確率和損失函數的圖表，幫助了解模型在訓練和驗證過程中的表現。</p>

              <!--Chart-->
              <div class="row">
                <div class="col-xl-6">
                  <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                      <i class="bi bi-graph-up"></i>
                      Model Accuracy
                    </div>
                    <div class="card-body"><canvas id="modelAccChart" width="100%"></canvas></div>
                    <div class="card-footer small bg-info text-white text-end">Updated at July-27-2024</div>
                  </div>
                </div>
                <div class="col-xl-6">
                  <div class="card mb-4">
                    <div class="card-header bg-warning text-white">
                      <i class="bi bi-graph-up"></i>
                      Model Loss
                    </div>
                    <div class="card-body"><canvas id="modelLossChart" width="100%"></canvas></div>
                    <div class="card-footer small bg-warning text-white text-end">Updated at July-27-2024</div>
                  </div>
                </div>
              </div>
              <!--AccChart Script-->
              <script>
                document.addEventListener('DOMContentLoaded', (event) => {
                  const ctx = document.getElementById('modelAccChart').getContext('2d');
                  const modelAccChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                      labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
                      datasets: [{
                        label: 'Train Accuracy',
                        data: [0.9070, 0.9706, 0.9782, 0.9821, 0.9853, 0.9870, 0.9885, 0.9895, 0.9901, 0.9904],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false
                      },
                      {
                        label: 'Test Accuracy',
                        data: [0.9805, 0.9863, 0.9886, 0.9895, 0.9902, 0.9910, 0.9904, 0.9919, 0.9908, 0.9923],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false
                      }
                      ]
                    },
                    options: {
                      scales: {
                        x: {
                          title: {
                            display: true,
                            text: 'Epochs',
                            color: '#911',
                            font: {
                              family: 'Comic Sans MS',
                              size: 20,
                              weight: 'bold',
                              lineHeight: 1.2
                            }
                          },
                          ticks: {
                            color: 'blue'
                          },
                          grid: {
                            display: false
                          }
                        },
                        y: {
                          title: {
                            display: true,
                            text: 'Accuracy',
                            color: '#191',
                            font: {
                              family: 'Times',
                              size: 15,
                              style: 'italic',
                              lineHeight: 1.5
                            }
                          },
                          ticks: {
                            color: 'green',
                            beginAtZero: true,
                            stepSize: 0.05
                          },
                          grid: {
                            color: 'rgba(200, 200, 200, 0.8)'
                          },
                          beginAtZero: true
                        }
                      }
                    }
                  });
                });
              </script>
              <!--LossChart Script-->
              <script>
                document.addEventListener('DOMContentLoaded', (event) => {
                  const ctx = document.getElementById('modelLossChart').getContext('2d');
                  const modelLossChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                      labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
                      datasets: [{
                        label: 'Train Loss',
                        data: [0.3028, 0.0986, 0.0750, 0.0591, 0.0503, 0.0428, 0.0398, 0.0341, 0.0315, 0.0304],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2,
                        fill: false
                      },
                      {
                        label: 'Test Loss',
                        data: [0.0601, 0.0407, 0.0342, 0.0305, 0.0294, 0.0266, 0.0291, 0.0247, 0.0289, 0.0251],
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        fill: false
                      }
                      ]
                    },
                    options: {
                      scales: {
                        x: {
                          title: {
                            display: true,
                            text: 'Epochs',
                            color: '#911',
                            font: {
                              family: 'Comic Sans MS',
                              size: 20,
                              weight: 'bold',
                              lineHeight: 1.2
                            }
                          },
                          ticks: {
                            color: 'blue'
                          },
                          grid: {
                            display: false
                          }
                        },
                        y: {
                          title: {
                            display: true,
                            text: 'Loss',
                            color: '#191',
                            font: {
                              family: 'Times',
                              size: 15,
                              style: 'italic',
                              lineHeight: 1.5
                            }
                          },
                          ticks: {
                            color: 'green',
                            beginAtZero: true,
                            stepSize: 0.05
                          },
                          grid: {
                            color: 'rgba(200, 200, 200, 0.8)'
                          },
                          beginAtZero: true
                        }
                      }
                    }
                  });
                });
              </script>
            </div>
            <!--==============================-->
            <div>
              <h5>步驟五、比較預測結果與真實結果</h5>
              <p>最後，比較模型的預測結果與實際標籤。</p>
              <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    # 預測測試集
                    predictions = model.predict(x_test)
                    
                    # 顯示一些測試結果
                    num_images = 10
                    plt.figure(figsize=(10, 10))
                    for i in range(num_images):
                        plt.subplot(5, 5, i + 1)
                        plt.imshow(x_test[i].reshape(28, 28), cmap='gray')
                        plt.title(f"True: {np.argmax(y_test[i])}, Pred: {np.argmax(predictions[i])}")
                        plt.axis('off')
                    plt.tight_layout()
                    plt.show()
                  </code>
                </pre>
              </div>
              <p>顯示 10 張測試圖像，每張圖像的標題包含了實際標籤和模型預測的結果。</p>

              <!--ImageCard-->
              <!--預測結果-->
              <div class="card mb-4">
                <div class="card-header"><i class="bi bi-image"></i>
                  預測結果
                </div>
                <div class="card-body text-center">
                  <img src="assets/img/MNISTfinaldig.png" alt="預測結果" class="img-fluid">
                  <div class="text-muted text-end">Updated at July-27-2024</div>
                </div>
              </div>
              <!--混淆矩陣-->
              <p>混淆矩陣可以更好地了解模型的性能</p>
                            <div>
                <pre class="bg-light p-3 rounded">
                  <code>
                    from sklearn.metrics import confusion_matrix
                    import seaborn as sns

                    # 將預測結果轉換為類別標籤
                    y_pred = np.argmax(predictions, axis=1)
                    y_true = np.argmax(y_test, axis=1)

                    # 計算混淆矩陣
                    conf_matrix = confusion_matrix(y_true, y_pred)

                    # 繪製混淆矩陣
                    plt.figure(figsize=(10, 8))
                    sns.heatmap(conf_matrix, annot=True, fmt='d', cmap='Blues', xticklabels=range(10),
                    yticklabels=range(10))
                    plt.xlabel('Predicted Label')
                    plt.ylabel('True Label')
                    plt.title('Confusion Matrix')
                    plt.show()

                  </code>
                </pre>
              </div>
              <div class="card mb-4">
                <div class="card-header"><i class="bi bi-image"></i>
                  混淆矩陣
                </div>
                <div class="card-body text-center">
                  <img src="assets/img/MNISTconfusematrix.png" alt="MNIST混淆矩陣" class="img-fluid">
                  <div class="text-muted text-end">Updated at July-27-2024</div>
                </div>
                <div class="card-footer">
                  <!-- Button trigger modal -->
                  <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button class="btn btn-danger me-md-2 btn-lg" data-bs-toggle="modal"
                      data-bs-target="#confuseMetrixModal" type="button">程式碼</button>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <!-- Modal Start -->
              <div class="modal fade" id="confuseMetrixModal" tabindex="-1" aria-labelledby="confuseMetrixModal"
                aria-hidden="true">
                <div class="modal-dialog modal-xl
            modal-dialog-centered modal-dialog-scrollable">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="confuseMetrixModal">產生混淆矩陣</h5>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <pre class="bg-light p-3 rounded">
                        <code>
                          from sklearn.metrics import confusion_matrix
                          import seaborn as sns

                          # 將預測結果轉換為類別標籤
                          y_pred = np.argmax(predictions, axis=1)
                          y_true = np.argmax(y_test, axis=1)

                          # 計算混淆矩陣
                          conf_matrix = confusion_matrix(y_true, y_pred)

                          # 繪製混淆矩陣
                          plt.figure(figsize=(10, 8))
                          sns.heatmap(conf_matrix, annot=True, fmt='d', cmap='Blues', xticklabels=range(10),
                          yticklabels=range(10))
                          plt.xlabel('Predicted Label')
                          plt.ylabel('True Label')
                          plt.title('Confusion Matrix')
                          plt.show()
                        </code>
                      </pre>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal End -->
            </div>

            <hr>
            <div>
              <h2>總結</h2>
              <p>使用 TensorFlow 和 Keras 在 Google Colab 中實現了一個 CNN 模型來識別 MNIST
                手寫數字。涵蓋了從數據準備、模型構建、模型訓練到結果可視化的過程。這是一個入門級的深度學習任務，非常適合用於理解卷積神經網絡的基本原理。</p>
            </div>
            <hr>
            <div>
              <h5>相關連結</h5>
              <a href="https://colab.research.google.com/drive/138e9nDDmXiqwjaXMdJbX5cB8GZvjqP_h?usp=sharing"
                target="_blank"><i class="bi bi-code-square"></i> Google
                Colab連結</a>
            </div>
          </div>
          <!--===============================-->
        </div>
      </main>
      <!--footer-->
      <footer class="py-4 bg-light mt-auto">
        <div class="container-fluid px-4">
          <div class="d-flex align-items-center justify-content-between small">
            <div class="text-muted">Copyright &copy; Abby's Website 2023</div>
          </div>
        </div>
      </footer>
      <!--===============================-->
    </div>
  </div>
  <!--Scripts-->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"></script>
  <script src="js/scripts.js"></script>
</body>

</html>
